(function(e,t){var n=t.body,a=t.querySelector.bind(t),o=t.querySelectorAll.bind(t),s=a("html"),r=a("#gotop"),c=a("#menu"),l=a("#header"),d=a("#mask"),f=a("#menu-toggle"),u=a("#menu-off"),v=a("#loading"),h=e.requestAnimationFrame,g=12,L=Array.prototype.forEach,m="ontouchstart"in e&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",p=function(){},x=function(e){var t=e.offsetLeft,n=e.offsetTop;if(e.offsetParent){var i=arguments.callee(e.offsetParent);t+=i.x,n+=i.y}return{x:t,y:n}},y=navigator.userAgent.indexOf("Firefox")!==-1?t.documentElement:n,w={goTop:function(e){var t=y.scrollTop,n=arguments.length>2?arguments[1]:Math.abs(t-e)/g;t&&t>e?(y.scrollTop=Math.max(t-n,0),h(arguments.callee.bind(this,e,n))):e&&t<e?(y.scrollTop=Math.min(t+n,e),h(arguments.callee.bind(this,e,n))):this.toc.actived(e)},toggleGotop:function(t){t>e.innerHeight/2?r.classList.add("in"):r.classList.remove("in")},toggleMenu:function(t){t?(c.classList.remove("hide"),e.innerWidth<1241&&(d.classList.add("in"),c.classList.add("show"),s.classList.add("lock"))):(c.classList.remove("show"),d.classList.remove("in"),s.classList.remove("lock"))},fixedHeader:function(e){e>l.clientHeight?l.classList.add("fixed"):l.classList.remove("fixed")},toc:function(){var e=a("#post-toc");if(!e||!e.children.length)return{fixed:p,actived:p};var t=x(e),n=t.y,s=l.clientHeight,r=a("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return e.querySelector('a[href="#'+r[0].id+'"]').parentNode.classList.add("active"),L.call(o('a[href^="#"]'),function(e){e.addEventListener("click",function(e){e.preventDefault();var t=x(a('[id="'+decodeURIComponent(this.hash).substr(1)+'"]')).y-s;h(w.goTop.bind(w,t))})}),{fixed:function(t){t>n-s?e.classList.add("fixed"):e.classList.remove("fixed")},actived:function(t){for(i=0,len=r.length;i<len;i++)if(t>x(r[i]).y-s-5){e.querySelector("li.active").classList.remove("active");var n=e.querySelector('a[href="#'+r[i].id+'"]').parentNode;n.classList.add("active")}t<x(r[0]).y&&(e.querySelector("li.active").classList.remove("active"),e.querySelector('a[href="#'+r[0].id+'"]').parentNode.classList.add("active"))}}}(),modal:function(e){function n(e){i.$modal.contains(e.target)||i.hide()}this.$modal=a(e),this.$off=this.$modal.querySelector(".close");var i=this;this.show=function(){d.classList.add("in"),i.$modal.classList.add("ready"),setTimeout(function(){i.$modal.classList.add("in"),t.addEventListener(m,n)},0)},this.hide=function(){d.classList.remove("in"),i.$modal.classList.remove("in"),setTimeout(function(){i.$modal.classList.remove("ready"),t.removeEventListener(m,n)},300)},this.toggle=function(){return i.$modal.classList.contains("in")?i.hide():i.show()},this.$off&&this.$off.addEventListener(m,this.hide)},share:function(){var e=a("#pageShare"),n=a("#shareFab"),i=new this.modal("#globalShare");a("#menuShare").addEventListener(m,i.toggle),n&&(n.addEventListener(m,function(){e.classList.toggle("in")},!1),t.addEventListener(m,function(t){!n.contains(t.target)&&e.classList.remove("in")},!1));var s=new this.modal("#wxShare");L.call(o(".wxFab"),function(e){e.addEventListener(m,s.toggle)})},search:function(){function e(){t.classList.toggle("in")}var t=a("#search-wrap");a("#search").addEventListener(m,e)},reward:function(){var e=new this.modal("#reward");a("#rewardBtn").addEventListener(m,e.toggle)},fixNavMinH:function(){function e(){t.style.minHeight=t.parentNode.clientHeight-t.nextElementSibling.offsetHeight+"px"}var t=a(".nav");return e}(),waterfall:function(){e.innerWidth<760||L.call(o(".waterfall"),function(e){var t=e.querySelectorAll(".waterfall-item"),n=[0,0];L.call(t,function(e){var t=n[0]<=n[1]?0:1;e.style.cssText="top:"+n[t]+"px;left:"+(t>0?"50%":0),n[t]+=e.offsetHeight}),e.style.height=Math.max(n[0],n[1])+"px",e.classList.add("in")})},tabBar:function(e){e.parentNode.parentNode.classList.toggle("expand")},page:function(){var e=o(".fade, .fade-scale");return{loaded:function(){L.call(e,function(e){e.classList.add("in")})},unload:function(){L.call(e,function(e){e.classList.remove("in")})}}}()};e.addEventListener("load",function(){w.fixNavMinH(),w.waterfall();var e=y.scrollTop;w.toc.fixed(e),w.toc.actived(e),v.classList.remove("active"),w.page.loaded()}),e.addEventListener("beforeunload",function(){w.page.unload()}),e.addEventListener("resize",function(){e.BLOG.even=m="ontouchstart"in e?"touchstart":"click",w.fixNavMinH(),w.toggleMenu(),w.waterfall()}),r.addEventListener(m,function(){h(w.goTop.bind(w,0))},!1),f.addEventListener(m,function(e){w.toggleMenu(!0),e.preventDefault()},!1),u.addEventListener(m,function(){c.classList.add("hide")},!1),d.addEventListener(m,function(){w.toggleMenu()},!1),t.addEventListener("scroll",function(){var e=y.scrollTop;w.toggleGotop(e),w.fixedHeader(e),w.toc.fixed(e),w.toc.actived(e)},!1),e.BLOG.SHARE&&w.share(),e.BLOG.REWARD&&w.reward(),w.docEl=y,w.noop=p,w.even=m,w.$=a,w.$$=o,Object.keys(w).reduce(function(e,t){return e[t]=w[t],e},e.BLOG),Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])})(window,document);